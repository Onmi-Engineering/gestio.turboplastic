<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <template id="onmi_report_exportacion_document">
            <t t-call="web.html_container">
                <style>
                    .page {
                        font-size: 12px !important;
                        padding: 0 !important;
                        margin: 0 !important;
                    }
                    .page .h2 {
                        font-size: 18px !important;
                        margin-top: 3px !important;
                        margin-bottom: 3px !important;
                    }
                    .page .table {
                        font-size: 12px !important;
                        margin-bottom: 5px !important;
                    }
                    .page span {
                        font-size: 12px !important;
                        line-height: 1.1 !important;
                    }
                    .page strong {
                        font-size: 12px !important;
                    }
                    .table td, .table th {
                        padding: 2px !important;
                        vertical-align: top !important;
                    }
                    .row {
                        margin-bottom: 3px !important;
                        margin-top: 0 !important;
                    }
                    .col-3, .col-5, .col-6 {
                        padding-right: 3px !important;
                        padding-left: 3px !important;
                    }
                    span br {
                        line-height: 0.9 !important;
                    }
                    .table-sm td {
                        padding: 1px !important;
                    }
                    .footer {
                        display: none !important;
                    }
                    .header {
                        display: none !important;
                    }
                    .invoice-header-row {
                        margin-top: 10px !important;
                        margin-bottom: 15px !important;
                    }
                    .label-value {
                        margin-bottom: 5px !important;
                    }
                    .table {
                        table-layout: fixed;
                        width: 100%;
                    }

                    .table td {
                        white-space: normal !important;
                        word-wrap: break-word !important;
                        word-break: break-word !important;
                    }
                </style>
                <t t-foreach="docs" t-as="doc">
                    <div class="article" t-att-data-oe-model="doc._name" t-att-data-oe-id="doc.id">
                        <div class="page">
                            <div class="row address">
                                <div class="col-5">
                                    <t t-if="doc.company_id.id == 1">
                                        <span>
                                            <span style="font-weight: bolder;">RECICLADOS MEDIOAMBIENTALES</span>
                                            <br/>
                                            <span style="font-weight: bolder;">TURBO PLASTIC SL</span>
                                            <br/>CR. CARTAGENA-ALHAMA 25<br/>30320 MURCIA<br/>ESPAÑA 968151130
                                            <br/>
                                            contabilidad@uplusrecycling.com<br/>VAT: ESB30768253
                                        </span>
                                    </t>
                                    <t t-if="doc.company_id.id == 4">
                                        <span>
                                            <span style="font-weight: bolder;">ENERGY PLASTIC SLU</span>
                                            <br/>CALLE ÓPALO 2
                                            <br/>30155 BAÑOS Y MENDIGO (MURCIA)
                                            <br/>ESPAÑA
                                            <br/>energyplastic@hotmail.com
                                            <br/>CIF: ESB05558986
                                        </span>
                                    </t>
                                    <t t-if="doc.company_id.id == 5">
                                        <span>
                                            <span style="font-weight: bolder;">RECITOTAL SL</span>
                                            <br/>CAMINO DEL CONGOSTO S/N<br/>16440 MONTALBO<br/>ESPAÑA 969130357
                                            <br/>
                                            recitotal@hotmail.com<br/>VAT: ESB86672680
                                        </span>
                                    </t>
                                </div>
                                <div class="col-5 offset-2">
                                    <div t-field="doc.partner_id" t-options-widget="'contact'"
                                         t-options-fields="['name', 'address', 'phone', 'mobile', 'email', 'vat']"
                                         class="small"/>
                                </div>
                            </div>
                            <div class="row" style="margin-top: 15px; margin-bottom: 15px;">
                                <div class="col h2">
                                    <span t-if="doc.move_type == 'out_refund'">CREDIT NOTE</span>
                                    <span t-if="doc.move_type == 'in_refund'">CREDIT NOTE</span>
                                    <span t-if="doc.move_type == 'out_invoice'">INVOICE</span>
                                    <span t-if="doc.move_type == 'in_invoice'">INVOICE</span>
                                </div>
                            </div>
                            <div class="row invoice-header-row">
                                <div class="col-4">
                                    <div class="label-value">
                                        <span t-if="doc.move_type == 'out_refund'">
                                            <strong>CREDIT NOTE NO:</strong>
                                        </span>
                                        <span t-if="doc.move_type == 'in_refund'">
                                            <strong>CREDIT NOTE NO:</strong>
                                        </span>
                                        <span t-if="doc.move_type == 'out_invoice'">
                                            <strong>INVOICE NO:</strong>
                                        </span>
                                        <span t-if="doc.move_type == 'in_invoice'">
                                            <strong>INVOICE NO:</strong>
                                        </span>
                                    </div>
                                    <span t-field="doc.name"/>
                                </div>
                                <div class="col-4">
                                    <div class="label-value">
                                        <span t-if="doc.move_type == 'out_refund'">
                                            <strong>CREDIT NOTE DATE:</strong>
                                        </span>
                                        <span t-if="doc.move_type == 'in_refund'">
                                            <strong>CREDIT NOTE DATE:</strong>
                                        </span>
                                        <span t-if="doc.move_type == 'out_invoice'">
                                            <strong>INVOICE DATE:</strong>
                                        </span>
                                        <span t-if="doc.move_type == 'in_invoice'">
                                            <strong>INVOICE DATE:</strong>
                                        </span>
                                    </div>
                                    <span t-field="doc.date"/>
                                </div>
                                <div class="col-4">
                                    <div class="label-value">
                                        <span>
                                            <strong>CONTRAT NO:</strong>
                                        </span>
                                    </div>
                                    <span t-field="doc.x_studio_contrat_no"/>
                                </div>
                            </div>
                            <table class="table o_report_block_table">
                                <thead>
                                    <tr>
                                        <th><span>Packages</span></th>
                                        <th><span>Type pack</span></th>
                                        <th><span>Container no</span></th>
                                        <th><span>Seal No</span></th>
                                        <th><span>Description</span></th>
                                        <th><span>Gross Weight</span></th>
                                        <th><span>Net Weight</span></th>
                                        <th><span>Price</span></th>
                                        <th><span>Amount</span></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr t-foreach="doc.invoice_line_ids" t-as="table_line">
                                        <t t-if="table_line.display_type != 'line_section' and table_line.display_type != 'line_note'">
                                            <td>
                                                <span t-field="table_line.x_studio_packages"/>
                                            </td>
                                            <td>
                                                <span t-field="table_line.inv_package_type"/>
                                            </td>
                                            <td>
                                                <span t-field="table_line.x_studio_container_no"/>
                                            </td>
                                            <td>
                                                <span t-field="table_line.x_studio_seal_no"/>
                                            </td>
                                            <td>
<!--                                                &lt;!&ndash; MODIFICACIÓN: Solo mostrar la descripción, no el nombre del producto &ndash;&gt;-->
<!--                                                <t t-set="description_text" t-value="table_line.name"/>-->
<!--                                                <t t-if="'\n' in description_text">-->
<!--                                                    <span t-esc="'\n'.join(description_text.split('\n')[1:])"/>-->
<!--                                                </t>-->
<!--                                                <t t-else="">-->
<!--                                                    &lt;!&ndash; Si no hay salto de línea, intentar usar la descripción del producto &ndash;&gt;-->
<!--                                                    <span t-field="table_line.product_id.description_sale" t-if="table_line.product_id.description_sale"/>-->
<!--                                                    <span t-field="table_line.name" t-if="not table_line.product_id.description_sale"/>-->
<!--                                                </t>-->
                                                <!-- Mostrar solo la descripción, eliminando el nombre del producto si está incluido -->
                                                <t t-set="name_txt"
                                                   t-value="table_line.name.replace('\r\n', '\n')"/>
                                                <t t-set="product_name"
                                                   t-value="table_line.product_id.display_name or ''"/>

                                                <t t-if="product_name and name_txt.startswith(product_name)">
                                                    <div t-esc="'\n'.join(name_txt.split('\n')[1:])"/>
                                                </t>
                                                <t t-else="">
                                                    <div t-esc="name_txt"/>
                                                </t>
                                            </td>
                                            <td>
                                                <span t-field="table_line.x_studio_gross_weight"/>
                                                <span t-field="table_line.product_uom_id.name"/>
                                            </td>
                                            <td>
                                                <span t-field="table_line.quantity"/>
                                                <span t-field="table_line.product_uom_id.name"/>
                                            </td>
                                            <td>
                                                <span t-field="table_line.price_unit"/>
                                                <span t-field="table_line.currency_id.symbol"/>
                                            </td>
                                            <td>
                                                <span t-if="doc.move_type == 'out_refund'"
                                                      t-field="table_line.inverse_subtotal"/>
                                                <span t-if="doc.move_type == 'in_refund'"
                                                      t-field="table_line.inverse_subtotal"/>
                                                <span t-if="doc.move_type == 'out_refund'"
                                                      t-field="table_line.currency_id.symbol"/>
                                                <span t-if="doc.move_type == 'in_refund'"
                                                      t-field="table_line.currency_id.symbol"/>
                                                <span t-if="doc.move_type == 'out_invoice'"
                                                      t-field="table_line.price_subtotal"/>
                                                <span t-if="doc.move_type == 'in_invoice'"
                                                      t-field="table_line.price_subtotal"/>
                                            </td>
                                        </t>
                                        <t t-else="">
                                            <td colspan="8">
                                                <span t-field="table_line.name"/>
                                            </td>
                                        </t>
                                    </tr>
                                </tbody>
                            </table>
                            <div class="row" style="margin-top: 10px;">
                                <div class="col-4">
                                    <div class="label-value">
                                        <span>
                                            <strong>HS CODE:</strong>
                                        </span>
                                    </div>
                                    <span t-field="doc.x_studio_hs_code"/>
                                </div>
                                <div class="col-4">
                                    <div class="label-value">
                                        <span>
                                            <strong>TOTAL (kg):</strong>
                                        </span>
                                    </div>
                                    <span t-field="doc.total_kg"/>
                                </div>
                                <div class="col-4">
                                    <div class="label-value">
                                        <span>
                                            <strong>TOTAL (Packages):</strong>
                                        </span>
                                    </div>
                                    <span t-field="doc.total_pkg"/>
                                </div>
                            </div>
                            <div class="row" style="margin-top: 10px;">
                                <div class="col-6"/>
                                <div t-if="doc.move_type == 'out_refund' or doc.move_type == 'in_refund' or doc.move_type == 'out_invoice' or doc.move_type == 'in_invoice'" class="col-6">
                                    <table class="table table-sm">
                                        <tr>
                                            <td><strong>Subtotal</strong></td>
                                            <td class="text-right">
                                                <span t-if="doc.move_type == 'out_refund' or doc.move_type == 'in_refund'" t-field="doc.inverse_total_untaxes"/>
                                                <span t-if="doc.move_type == 'out_invoice' or doc.move_type == 'in_invoice'" t-field="doc.amount_untaxed"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td><strong>Total</strong></td>
                                            <td class="text-right">
                                                <span t-if="doc.move_type == 'out_refund' or doc.move_type == 'in_refund'" t-field="doc.inverse_total_taxes"/>
                                                <span t-if="doc.move_type == 'out_invoice' or doc.move_type == 'in_invoice'" t-field="doc.amount_total"/>
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                            </div>
                            <div class="row" style="margin-top: 10px;">
                                <div class="col-3">
                                    <div class="label-value">
                                        <span>
                                            <strong>INCOTERM:</strong>
                                        </span>
                                    </div>
                                    <span t-field="table_line.move_id.invoice_incoterm_id.name"/>
                                </div>
                                <div class="col-3">
                                    <div class="label-value">
                                        <span>
                                            <strong>ORIGIN:</strong>
                                        </span>
                                    </div>
                                    <span t-field="table_line.move_id.x_studio_origin"/>
                                </div>
                                <div class="col-3"/>
                                <div class="col-3"/>
                            </div>
                            <div name="ports" class="row" style="margin-top: 5px;">
                                <div class="col-3">
                                    <div class="label-value">
                                        <span>
                                            <strong>PORT OF LOADING:</strong>
                                        </span>
                                    </div>
                                    <span t-field="table_line.move_id.x_studio_port_of_loading"/>
                                </div>
                                <div class="col-3">
                                    <div class="label-value">
                                        <span>
                                            <strong>PORT OF DISCHARGE:</strong>
                                        </span>
                                    </div>
                                    <span t-field="table_line.move_id.x_studio_port_of_discharge"/>
                                </div>
                                <div class="col-3"/>
                                <div class="col-3"/>
                            </div>
                            <div class="row" style="margin-top: 15px;">
                                <div class="col-6">
                                    <t t-if="doc.company_id.id == 1">
                                        <span>
                                            RECICLADOS MEDIOAMBIENTALES TURBO PLASTIC S.L.
                                            <br/>
                                            CTRA. CARTAGENA -ALHAMA KM 25.
                                            <br/>
                                            30320 FUENTE ALAMO DE MURCIA (MURCIA) ESPAÑA
                                            <br/>
                                            TAX ID: ESB30768253
                                        </span>
                                    </t>
                                    <t t-if="doc.company_id.id == 4">
                                        <span>
                                            ENERGY PLASTIC SLU
                                            <br/>
                                            CALLE ÓPALO 2
                                            <br/>
                                            30155 BAÑOS Y MENDIGO (MURCIA) ESPAÑA
                                            <br/>
                                            TAX ID: ESB05558986
                                        </span>
                                    </t>
                                    <t t-if="doc.company_id.id == 5">
                                        <span>
                                            RECITOTAL SL
                                            <br/>
                                            CAMINO DEL CONGOSTO S/N
                                            <br/>
                                            16440 MONTALBO (CUENCA) ESPAÑA
                                            <br/>
                                            TAX ID: ESB86672680
                                        </span>
                                    </t>
                                </div>
                                <div name="accounts" class="col-6 text-right">
                                    <t t-if="doc.company_id.id == 1">
                                        <span>
                                            BANK NAME:BANCO SANTANDER SA
                                            <br/>
                                            BANK ADD:CALLE SANTO DOMINGO 10. 16440 MONTALBO(CUENCA) ESPAÑA
                                            <br/>
                                            EUR ACCOUNTE:ES54 0049 2883 5127 1405 2631
                                            <br/>
                                            BIC/SWIFT:BSCHESMM
                                        </span>
                                    </t>
                                    <t t-if="doc.company_id.id == 4">
                                        <span>
                                            BANK NAME:BANCO SANTANDER SA
                                            <br/>
                                            BANK ADD:CALLE SANTO DOMINGO 10. 16440 MONTALBO(CUENCA) ESPAÑA
                                            <br/>
                                            EUR ACCOUNT:ES35 0049 2883 5422 1405 3425
                                            <br/>
                                            BIC/SWIFT:BSCHESMM
                                        </span>
                                    </t>
                                    <t t-if="doc.company_id.id == 5">
                                        <span>
                                            BANK NAME: SANTANDER
                                            <br/>
                                            ADRESS: CAMINO DEL CONGOSTO S/N
                                            <br/>
                                            EURO ACCOUNT: ES74 0049 2883 5620 1405 2011
                                            <br/>
                                            BIC: BSCHESMM
                                        </span>
                                    </t>
                                </div>
                            </div>
                        </div>
                    </div>
                </t>
            </t>
        </template>

        <template id="onmi_report_exportacion">
            <t t-foreach="docs" t-as="o">
                <t t-call="onmi_turbo_credit_note.onmi_report_exportacion_document"
                   t-options-lang="o.partner_id.lang"/>
            </t>
        </template>

    </data>
</odoo>